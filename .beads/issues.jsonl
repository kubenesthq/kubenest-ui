{"id":"kubenest-ui-0e6","title":"Complete workload deployment flow","description":"Deploy workloads, view workload details with real-time SSE status updates","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-26T11:45:50.946002+05:30","updated_at":"2025-11-26T11:45:50.946002+05:30"}
{"id":"kubenest-ui-2wp","title":"Add Helm chart deploy mode to workload creation form","description":"## Context\n\nThe backend now supports deploying workloads via custom Helm charts instead of the default kubenest-workload chart. The API accepts two new optional fields on POST /workloads:\n- `chart`: `{ repo: string, name: string, version: string }`\n- `values`: arbitrary JSON object of Helm values\n\nThe workload response object now includes `chart_config: { chart?: ChartSpec, values?: Record\u003cstring, unknown\u003e } | null`.\n\n## Goal\n\nExtend the \"Deploy New Workload\" form and workload detail page to support Helm chart deployments alongside the existing image-based flow.\n\n---\n\n## Files to change\n\n### 1. `types/api.ts`\n\nAdd `ChartSpec` interface and extend existing types:\n\n\\`\\`\\`ts\nexport interface ChartSpec {\n  repo: string;   // Helm repo URL, e.g. https://charts.bitnami.com/bitnami\n  name: string;   // Chart name, e.g. postgresql\n  version: string; // Semver chart version, e.g. 12.1.2\n}\n\\`\\`\\`\n\nAdd to `Workload` interface:\n\\`\\`\\`ts\nchart_config: { chart?: ChartSpec; values?: Record\u003cstring, unknown\u003e } | null;\n\\`\\`\\`\n\nAdd to `CreateWorkloadRequest`:\n\\`\\`\\`ts\nchart?: ChartSpec;\nvalues?: Record\u003cstring, unknown\u003e;\n\\`\\`\\`\n\n---\n\n### 2. `app/projects/[id]/workloads/new/page.tsx`\n\n#### Deploy mode toggle\n\nAdd a mode selector at the top of the form with two options: **Image** (default) and **Helm Chart**. Use `useState\u003c'image' | 'chart'\u003e('image')`.\n\n#### Updated Zod schema\n\nRemove the hard `z.string().min(1)` requirement on `image`. Add chart fields. Use `.superRefine()` to cross-validate:\n- In `image` mode: `image` is required\n- In `chart` mode: `chart.repo`, `chart.name`, `chart.version` are all required; `image` is ignored\n\n\\`\\`\\`ts\nconst chartSpecSchema = z.object({\n  repo: z.string().url('Must be a valid URL'),\n  name: z.string().min(1, 'Chart name is required'),\n  version: z.string().min(1, 'Version is required'),\n});\n\nconst workloadSchema = z.object({\n  name: z.string().min(1).regex(/^[a-z0-9-]+$/),\n  image: z.string().optional(),\n  replicas: z.number().int().min(0).max(100),\n  port: z.number().int().min(1).max(65535).optional().nullable(),\n  ingress: ingressSchema.optional(),\n  chart: chartSpecSchema.optional(),\n  valuesYaml: z.string().optional(), // raw YAML/JSON text input, parsed before submit\n});\n\\`\\`\\`\n\n#### Conditional field rendering\n\nWhen mode is `'image'`: show `Container Image` field (required), hide chart fields.\nWhen mode is `'chart'`: hide image field, show three chart fields (Repo, Name, Version) + optional Helm Values textarea.\n\n#### Helm Values textarea\n\n- Collapsible section (same pattern as Ingress)\n- Accepts YAML or JSON (use `js-yaml` if already in deps, else JSON only is fine)\n- Parse to object before submitting; show parse error inline if invalid\n\n#### `onSubmit` handler changes\n\n\\`\\`\\`ts\n// image mode (current behavior unchanged)\nif (mode === 'image') {\n  payload.image = data.image;\n}\n\n// chart mode\nif (mode === 'chart') {\n  payload.chart = data.chart;\n  if (data.valuesYaml) {\n    try {\n      payload.values = JSON.parse(data.valuesYaml); // or yaml.load()\n    } catch {\n      setError('valuesYaml', { message: 'Invalid JSON/YAML' });\n      return;\n    }\n  }\n}\n\\`\\`\\`\n\n---\n\n### 3. `app/workloads/[id]/page.tsx`\n\nIn the **Workload Details** card, update the source row:\n\n- If `workload.chart_config?.chart` exists: show chart badge with repo/name@version instead of the Image row\n- If `workload.image` exists: show the existing Image row (no change)\n- Both can coexist (image + values override case), but chart takes priority as the label\n\nReplace the hardcoded `Image` entry in the details array with:\n\n\\`\\`\\`tsx\nworkload.chart_config?.chart\n  ? {\n      label: 'Helm Chart',\n      value: (\n        \u003ccode className=\"text-xs bg-zinc-100 text-zinc-700 px-2 py-1 rounded font-mono block truncate\"\u003e\n          {workload.chart_config.chart.name}@{workload.chart_config.chart.version}\n          \u003cspan className=\"text-zinc-400 ml-1\"\u003e({workload.chart_config.chart.repo})\u003c/span\u003e\n        \u003c/code\u003e\n      ),\n    }\n  : {\n      label: 'Image',\n      value: (\n        \u003ccode className=\"text-xs bg-zinc-100 text-zinc-700 px-2 py-1 rounded font-mono block truncate\"\u003e\n          {workload.image}\n        \u003c/code\u003e\n      ),\n    },\n\\`\\`\\`\n\nIf `chart_config.values` is non-empty, add a collapsible **Helm Values** section below the details card showing the values as formatted JSON.\n\n---\n\n## Acceptance criteria\n\n- [ ] Deploy form shows Image/Helm Chart toggle\n- [ ] Image mode: existing behaviour unchanged, all existing tests pass\n- [ ] Chart mode: chart repo/name/version fields shown and validated\n- [ ] Chart mode: Helm Values textarea accepts JSON and shows parse errors\n- [ ] Submitting in chart mode sends `{ chart: {...}, values: {...} }` in the API payload (no `image`)\n- [ ] Workload detail page shows \"Helm Chart\" source row instead of \"Image\" when `chart_config` is set\n- [ ] TypeScript types are updated — no `any` casts needed\n\n## Notes\n\n- `WorkloadPhase` in `types/api.ts` currently has lowercase values (`running`, `failed`, etc.) but the backend returns Title-case (`Running`, `Failed`). Check if this mismatch causes any issues while you are in this file.\n- No new dependencies are strictly required; use JSON.parse for values unless js-yaml is already installed.\n- The `lib/api/workloads.ts` and `hooks/useWorkloads.ts` files do NOT need changes — they pass the payload through as-is.","status":"open","priority":2,"issue_type":"feature","owner":"badri.dilbert@gmail.com","created_at":"2026-02-19T13:40:58.325157+05:30","created_by":"Lakshmi Narasimhan","updated_at":"2026-02-19T13:40:58.325157+05:30"}
{"id":"kubenest-ui-9ch","title":"Add real-time SSE status updates","description":"Implement SSE provider and hooks for live workload status updates","status":"open","priority":1,"issue_type":"feature","created_at":"2025-11-26T11:45:59.097971+05:30","updated_at":"2025-11-26T11:45:59.097971+05:30","dependencies":[{"issue_id":"kubenest-ui-9ch","depends_on_id":"kubenest-ui-0e6","type":"parent-child","created_at":"2025-11-26T11:46:16.677719+05:30","created_by":"daemon","metadata":"{}"}]}
{"id":"kubenest-ui-bbx","title":"Complete cluster management flow","description":"Register clusters, view cluster details, copy install command","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-26T11:45:50.368118+05:30","updated_at":"2025-11-26T11:45:50.368118+05:30"}
{"id":"kubenest-ui-ddu","title":"Fix Toaster component import error","description":"Toaster component was missing - needed use-toast.ts and toaster.tsx","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-11-26T11:46:04.084068+05:30","updated_at":"2025-11-26T11:46:09.009991+05:30","closed_at":"2025-11-26T11:46:09.009991+05:30"}
{"id":"kubenest-ui-jdi","title":"Complete MVP authentication flow","description":"Ensure login/register/logout works end-to-end with proper state management","notes":"COMPLETED: Fixed auth API endpoints to match backend (login uses form-urlencoded, register uses /user endpoint). Login and register pages now functional with proper API calls.\nIN PROGRESS: Need to verify login/register flow works end-to-end.\nNEXT: Test with real user credentials.","status":"in_progress","priority":1,"issue_type":"epic","created_at":"2025-11-26T11:45:50.120014+05:30","updated_at":"2025-11-26T12:00:15.255209+05:30"}
{"id":"kubenest-ui-qxy","title":"Polish and error handling","description":"Loading states, error pages, form validation, responsive design","status":"open","priority":2,"issue_type":"epic","created_at":"2025-11-26T11:45:59.435732+05:30","updated_at":"2025-11-26T11:45:59.435732+05:30"}
{"id":"kubenest-ui-wqw","title":"Complete project management flow","description":"Create projects within clusters, view project details and workloads","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-26T11:45:50.593302+05:30","updated_at":"2025-11-26T11:45:50.593302+05:30"}
